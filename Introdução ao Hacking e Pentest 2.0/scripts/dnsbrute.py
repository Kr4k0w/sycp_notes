#!/usr/bin/env python3

import dns.resolver

# Criando variável que armazena a class `Resolver()`
resolver = dns.resolver.Resolver()

target = "bancocn.com"

# Abre o arquivo para utilizar como wordlist
with open("/usr/share/dnsenum/dns.txt", "r") as wordlist:
    subdomains = wordlist.read().splitlines()

# Para cada subdominio na lista, realiza uma tentativa
for subdomain in subdomains:
    try:
        # Utilizando o método `resolve()` podemos passar o subdomínio e o tipo de entrada.
        # MX - email, TXT - informações, A - endereço
        result = resolver.resolve(f"{subdomain}.{target}", "A")

        # Loop para iterar sobre as informações do objeto retornado
        for ip in result:
            print(f"{subdomain}.{target}", "->", ip)

    except Exception:
        pass
